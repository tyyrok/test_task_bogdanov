# Тестовое задание: Разработать API на FastAPI с подключенным ботом на Aiogram

## Используется стек:

1. Fastapi, SQLAlchemy, Celery, Redis
2. Aiogram для написания простого бота

## Доступные эндпоинты API:

1. GET /api/v1/products/{article}/ - эндпоинт для чтения продукта по артикулу
2. POST /api/v1/products/ - эндпоинт для парсинга продукта по артикулу
3. GET /api/v1/subscribe/{article}/ - эндпоинт для подписки на обновления продукта по артикулу (обновление каждые 30 минут)

## Запуск Проекта

При запуске создает файл ``` src/cofigs/.env ``` из ``` .env.template ``` если его нет.<br>
**Желательно его его скопировать самостоятельно и отредактировать значения переменных**

**Частичный запуск в Docker**
1. Раскомментировать ports для redis и db в docker-compose.yml
2. Запускаем через bash команду
```bash
./start.sh
```
3. FastAPI запускается локально, с возможность быстрого autoreload при изменении кода. PSQL, Redis, Celery запускаются в докере
4. Запускаем Телеграм бота 
```bash
python ./bot/bot.py
```

**Полный запуск в Docker**
1. Закомментировать external networks и раскомментировать ports в docker-compose-core.yml
2. Запускаем через bash команду
```bash
./start-full.sh
```
3. Все запускается в докере (FastAPI, PSQL, Redis, Celery)
4. Запускаем Телеграм бота 
```bash
python ./bot/bot.py
```


#### Внимание!!! Если вы запускали проект частично в докере и наоборот, то при изменении запуска требуется удалить текущий файл src/.env 


## Swagger
Swagger проекта после запуска доступен по адресу - http://127.0.0.1:8000/api/v1/docs/ (при запуске без API Gateway)
